<!DOCTYPE html>
<!--
  2019 (c) GNU - DOUGLAS BERDEAUX, PinStackSmashing.com
  weaknetlabs.com, weaknetlabs.org, demonlinux.com, idqat.com
  #infosec #lockpicking #lockpick #hacking #redteam #pentest
-->
<html>
<head>
  <title>Master Lock Co. Model 653D Decoder</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <style>
    body{
      background-color:#fff;
      font-family:'Arial';
    }
    .topBar{
    }
    .topBarItem{
      display:inline-block;
      padding:10px 10px 10px 10px;
      color:#606060;
      margin:0 10px 10px 10px;
      background-color:#cbcbcb;
      border-radius:5px;
      text-align:center;
    }
    .wheel{
      display:inline-block;
      margin:10px;
      padding:10px;
      font-size:30px;
      background-color:#b0b0b0;
      border-radius:5px;
      color:#fff;
    }
    .content{
      width:100%;
      height:100%;
      text-align:center;
      padding:5% 0 0 0;
    }
    .combinations{
      margin:10px 0 0 0;
    }
    .combinationsItem{
      display:inline-block;
    }
    .description{
      font-size:10px;
      padding:10px;
      margin: 0 0 20px 0;
    }
  </style>

  <script>
    wheelUpdate = function(div){
      document.getElementById("wheel"+div).innerHTML = document.getElementById("wheelSelect"+div).value;
      document.getElementById("wheel"+div).style.color="#0081ff";
    }
    fillCombinations = function(){
      // Get the first wheel values into array:
      var wheel1 = [document.getElementById("wheelSelect1a").value,document.getElementById("wheelSelect1b").value];
      var wheel2 = [document.getElementById("wheelSelect2a").value,document.getElementById("wheelSelect2b").value];
      var wheel3 = [document.getElementById("wheelSelect3a").value,document.getElementById("wheelSelect3b").value];
      var wheel4 = [document.getElementById("wheelSelect4a").value,document.getElementById("wheelSelect4b").value];
      for (a=0;a<wheel1.length;a++){
        for (b=0;b<wheel2.length;b++){
          for (c=0;c<wheel3.length;c++){
            for (d=0;d<wheel4.length;d++){
              string = wheel1[a]+wheel2[b]+wheel3[c]+wheel4[d];
              document.getElementById("combinations").innerHTML+=string+"<br />";
            }
          }
        }
      }
    }
  </script>

</head>
<body>
  <div class="content">
    <h1>Master Lock Co. <b>Model 653D</b> Decoder</h1>
    <div class="description">
      PoC that breaks down 10,000 possible permutations of a 4 wheel, 10 option/wheel, lock, to only 16 possible outcomes.<br />
      This requires phsyical access to the lock and each wheel be tested with a shim. Upon each "click" notice the two numbers<br />
      on either side of the stopped wheel in the 4 windows on the edge of the lock. Select these two sets of values per wheel below.<br />
      See <a href="">episode 6 of Pin Stack Smashing</a> for demonstration.<br />
    </div>
    <div class="topBar">
      <div class="topBarItem">
        <h3>Wheel 4:</h3><br />
        <select onchange="javascript:wheelUpdate('4a')" id="wheelSelect4a" name="wheel4a">
          <option value="0">5|6</option>
          <option value="1">6|7</option>
          <option value="2">7|8</option>
          <option value="3">8|9</option>
          <option value="4">0|9</option>
          <option value="5">0|1</option>
          <option value="6">1|2</option>
          <option value="7">2|3</option>
          <option value="8">3|4</option>
          <option value="9">4|5</option>
        </select><br /><br />
        <select name="wheel4b" onchange="javascript:wheelUpdate('4b')" id="wheelSelect4b">
          <option value="0">5|6</option>
          <option value="1">6|7</option>
          <option value="2">7|8</option>
          <option value="3">8|9</option>
          <option value="4">0|9</option>
          <option value="5">0|1</option>
          <option value="6">1|2</option>
          <option value="7">2|3</option>
          <option value="8">3|4</option>
          <option value="9">4|5</option>
        </select><br />
        <div class="wheel">
          <span id="wheel4a">0</span> |
          <span id="wheel4b">0</span>
        </div>
      </div>
      <div class="topBarItem">
        <h3>Wheel 3:</h3><br />
        <select name="wheel3a" onchange="javascript:wheelUpdate('3a')" id="wheelSelect3a">
          <option value="0">5|6</option>
          <option value="1">6|7</option>
          <option value="2">7|8</option>
          <option value="3">8|9</option>
          <option value="4">0|9</option>
          <option value="5">0|1</option>
          <option value="6">1|2</option>
          <option value="7">2|3</option>
          <option value="8">3|4</option>
          <option value="9">4|5</option>
        </select>
        <br /><br />
        <select name="wheel3b" onchange="javascript:wheelUpdate('3b')" id="wheelSelect3b">
          <option value="0">5|6</option>
          <option value="1">6|7</option>
          <option value="2">7|8</option>
          <option value="3">8|9</option>
          <option value="4">0|9</option>
          <option value="5">0|1</option>
          <option value="6">1|2</option>
          <option value="7">2|3</option>
          <option value="8">3|4</option>
          <option value="9">4|5</option>
        </select><br />
        <div class="wheel">
          <span id="wheel3a">0</span> |
          <span id="wheel3b">0</span>
        </div>
      </div>
      <div class="topBarItem">
        <h3>Wheel 2:</h3><br />
        <select name="wheel2a" onchange="javascript:wheelUpdate('2a')" id="wheelSelect2a">
          <option value="0">5|6</option>
          <option value="1">6|7</option>
          <option value="2">7|8</option>
          <option value="3">8|9</option>
          <option value="4">0|9</option>
          <option value="5">0|1</option>
          <option value="6">1|2</option>
          <option value="7">2|3</option>
          <option value="8">3|4</option>
          <option value="9">4|5</option>
        </select><br /><br />
        <select name="wheel2b" onchange="javascript:wheelUpdate('2b')" id="wheelSelect2b">
          <option value="0">5|6</option>
          <option value="1">6|7</option>
          <option value="2">7|8</option>
          <option value="3">8|9</option>
          <option value="4">0|9</option>
          <option value="5">0|1</option>
          <option value="6">1|2</option>
          <option value="7">2|3</option>
          <option value="8">3|4</option>
          <option value="9">4|5</option>
        </select><br />
        <div class="wheel">
          <span id="wheel2a">0</span> |
          <span id="wheel2b">0</span>
        </div>
      </div>
      <div class="topBarItem">
        <h3>Wheel 1:</h3><br />
        <select name="wheel1a" onchange="javascript:wheelUpdate('1a')" id="wheelSelect1a">
          <option value="0">5|6</option>
          <option value="1">6|7</option>
          <option value="2">7|8</option>
          <option value="3">8|9</option>
          <option value="4">0|9</option>
          <option value="5">0|1</option>
          <option value="6">1|2</option>
          <option value="7">2|3</option>
          <option value="8">3|4</option>
          <option value="9">4|5</option>
        </select><br /><br />
        <select name="wheel1b" onchange="javascript:wheelUpdate('1b')" id="wheelSelect1b">
          <option value="0">5|6</option>
          <option value="1">6|7</option>
          <option value="2">7|8</option>
          <option value="3">8|9</option>
          <option value="4">0|9</option>
          <option value="5">0|1</option>
          <option value="6">1|2</option>
          <option value="7">2|3</option>
          <option value="8">3|4</option>
          <option value="9">4|5</option>
        </select>
        <br />
        <div class="wheel">
          <span id="wheel1a">0</span> |
          <span id="wheel1b">0</span>
        </div>
      </div>
    </div><br />
    <button class="btn btn-primary" onclick="fillCombinations()">Show Combinations</button>
    <br />
    <div class="combinations" id="combinations">
    </div>
  </div>
</body>
</html>
